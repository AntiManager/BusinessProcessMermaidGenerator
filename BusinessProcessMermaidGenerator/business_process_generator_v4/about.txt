ГЕНЕРАТОР ДИАГРАММ БИЗНЕС-ПРОЦЕССОВ - ДОКУМЕНТАЦИЯ ПРОЕКТА
Версия 3.0 с улучшенным GUI и автоматическим выбором листов

🏗️ СТРУКТУРА ПРОЕКТА

business_process_generator/
├── 📁 exporters/                    # Модули экспорта
│   ├── __init__.py
│   ├── mermaid_exporter.py         # Экспорт в Mermaid (Markdown/HTML)
│   ├── html_exporter.py            # HTML с Mermaid + панорамирование
│   ├── interactive_exporter.py     # Интерактивный граф (vis-network)
│   └── svg_exporter.py             # HTML с SVG (УЛУЧШЕННАЯ НАВИГАЦИЯ)
├── 📄 main.py                      # Точка входа (ТОЛЬКО GUI)
├── 📄 gui_interface.py             # УЛУЧШЕННЫЙ графический интерфейс
├── 📄 config_manager.py            # Менеджер конфигурации
├── 📄 config.py                    # Конфигурация и константы
├── 📄 models.py                    # Data classes и модели
├── 📄 utils.py                     # Утилиты и вспомогательные функции
├── 📄 data_loader.py               # Загрузка и обработка данных
├── 📄 analysis.py                  # Анализ бизнес-процессов
└── 📄 bp_config.json               # Сохраненная конфигурация (АВТОМАТИЧЕСКИ)

🆕 НОВЫЕ ВОЗМОЖНОСТИ ВЕРСИИ 3.0

1. УЛУЧШЕННЫЙ ГРАФИЧЕСКИЙ ИНТЕРФЕЙС
   - Автоматический выбор листов из Excel файла
   - Выпадающий список всех доступных листов
   - Кнопка "Обновить" для перезагрузки списка листов
   - Умное определение листа по умолчанию
   - Улучшенная валидация полей ввода

2. УПРОЩЕННАЯ АРХИТЕКТУРА
   - УДАЛЕН КОНСОЛЬНЫЙ РЕЖИМ - только GUI
   - Удален модуль user_input.py (больше не нужен)
   - Упрощенный запуск приложения
   - Лучшая обработка ошибок

3. УЛУЧШЕННЫЙ ПОЛЬЗОВАТЕЛЬСКИЙ ОПЫТ
   - Эмодзи для лучшей визуализации
   - Понятные сообщения об ошибках
   - Автоматическое определение имени выходного файла
   - Информационная панель о возможностях SVG

🎯 ФОРМАТЫ ВЫВОДА И ИХ ПРЕИМУЩЕСТВА

1. 📄 MARKDOWN WITH MERMAID
   • Идеально для документации
   • Совместимость с GitHub/GitLab
   • Простота редактирования

2. 🌐 HTML WITH MERMAID  
   • Интерактивное панорамирование
   • Масштабирование и навигация
   • Профессиональный внешний вид

3. 🎮 ИНТЕРАКТИВНЫЙ HTML (vis-network)
   • Динамическая компоновка узлов
   • Физическое моделирование
   • Поиск и фильтрация элементов
   • Детальная информация по узлам

4. 🖼️ HTML WITH SVG (РЕКОМЕНДУЕМЫЙ)
   • Векторная графика высокого качества
   • ПРОДВИНУТАЯ НАВИГАЦИЯ:
     - 🖱️  ЛКМ - перетаскивание диаграммы
     - 🔍 Колесо мыши - масштабирование
     - ⌨️  Ctrl+колесо - точное масштабирование
     - 📍 Подсказки при наведении на узлы
     - 📊 Отображение координат
   • Экспорт в PNG с текущим видом
   • Полноэкранный режим
   • Адаптивный дизайн

🔧 РАБОЧИЙ ПРОЦЕСС С УЛУЧШЕННЫМ GUI

1. Запустите программу (автоматически открывается GUI)
2. Выберите файл Excel через кнопку "Обзор..."
3. ✅ АВТОМАТИЧЕСКИ загружается список доступных листов
4. Выберите нужный лист из выпадающего списка
5. Настройте параметры визуализации:
   - Формат вывода (рекомендуется SVG)
   - Группировка операций
   - Отображение подробного описания
   - Пороги для критических операций
6. Нажмите "🎯 Сгенерировать диаграмму"
7. Программа автоматически откроет результат в браузере

🎮 УПРАВЛЕНИЕ SVG ДИАГРАММАМИ

ОСНОВНЫЕ КОМАНДЫ:
┌───────────────────┬────────────────────────────────────────┐
│ Действие          │ Управление                            │
├───────────────────┼────────────────────────────────────────┤
│ Перетаскивание    │ Зажать ЛКМ и двигать мышью           │
│ Масштабирование   │ Колесо мыши вверх/вниз               │
│ Точный зум        │ Ctrl + колесо мыши                   │
│ Сброс вида        │ Кнопка "Сброс" или Ctrl+0            │
│ Вписать в экран   │ Кнопка "Вместить" или Ctrl+1         │
│ Полный экран      │ Кнопка "⛶" или F11                  │
│ Скачать PNG       │ Кнопка "📥 PNG"                      │
└───────────────────┴────────────────────────────────────────┘

💾 СИСТЕМА КОНФИГУРАЦИИ

- Настройки автоматически сохраняются при закрытии
- Файл конфигурации: bp_config.json
- SVG формат установлен по умолчанию (рекомендуется)
- Содержит:
  * excel_path: путь к последнему файлу Excel
  * sheet_name: последний выбранный лист
  * output_format: предпочтительный формат вывода (svg)
  * subgroup_column: столбец для группировки
  * show_detailed: показывать подробное описание
  * critical_min_inputs: порог входов для критических операций
  * critical_min_reuse: порог использований выхода
  * no_grouping: отключить группировку

🔄 ПРЕИМУЩЕСТВА НОВОЙ ВЕРСИИ 3.0

1. ИНТУИТИВНЫЙ ИНТЕРФЕЙС:
   - Автоматическое обнаружение листов Excel
   - Выпадающие списки вместо ручного ввода
   - Визуальные подсказки и эмодзи
   - Умное определение значений по умолчанию

2. УПРОЩЕННАЯ АРХИТЕКТУРА:
   - Только графический интерфейс
   - Удалены избыточные компоненты
   - Лучшая производительность
   - Проще в использовании

3. УЛУЧШЕННАЯ ОБРАБОТКА ОШИБОК:
   - Валидация обязательных полей
   - Информативные сообщения об ошибках
   - Защита от некорректных данных
   - Автоматическое восстановление

4. ПРОДУМАННАЯ ФУНКЦИОНАЛЬНОСТЬ:
   - Кнопка "Обновить" для перезагрузки листов
   - Автоматическое именование выходных файлов
   - Сохранение состояния между сессиями
   - Адаптация под разные сценарии использования

🐛 РЕШЕНИЕ ТИПИЧНЫХ ПРОБЛЕМ

ПРОБЛЕМА: Не отображаются листы в выпадающем списке
РЕШЕНИЕ: Нажмите кнопку "Обновить" рядом с выбором листа

ПРОБЛЕМА: SVG диаграмма не реагирует на управление
РЕШЕНИЕ: Убедитесь что JavaScript включен в браузере

ПРОБЛЕМА: Не работает перетаскивание
РЕШЕНИЕ: Используйте левую кнопку мыши для перетаскивания

ПРОБЛЕМА: Программа не запускается
РЕШЕНИЕ: Убедитесь что установлен Tkinter (обычно входит в стандартную поставку Python)

ПРОБЛЕМА: Не сохраняются настройки
РЕШЕНИЕ: Проверьте права на запись в директории программы

ПРОБЛЕМА: Ошибка при чтении Excel файла
РЕШЕНИЕ: Убедитесь что файл не открыт в Excel и имеет правильный формат

📞 ПОДДЕРЖКА И ОБРАТНАЯ СВЯЗЬ

При возникновении проблем:
1. Убедитесь что используете последнюю версию программы (3.0)
2. Проверьте что Excel файл содержит обязательные колонки: "Операция", "Входы", "Выход"
3. Убедитесь в поддержке JavaScript в браузере для SVG формата
4. Попробуйте сбросить настройки через GUI

ОСОБЕННОСТИ РАБОТЫ ВЕРСИИ 3.0:
- Программа не блокирует Excel файл - можно вносить правки параллельно
- При изменении Excel файла просто перегенерируйте диаграмму
- SVG формат рекомендуется для большинства сценариев использования
- Настройки автоматически адаптируются под выбранный формат вывода
- Автоматическое определение листа по умолчанию (ищет "БП_1", "Sheet1", "Лист1")

🚀 СОВЕТЫ ПО ИСПОЛЬЗОВАНИЮ ВЕРСИИ 3.0

1. ДЛЯ БОЛЬШИХ ДИАГРАММ:
   - Используйте SVG формат для лучшей производительности
   - Применяйте группировку для упрощения визуализации
   - Используйте полноэкранный режим для обзора

2. ДЛЯ ПРЕЗЕНТАЦИЙ:
   - Экспортируйте в PNG с нужным масштабом
   - Используйте подсказки для объяснения узлов
   - Применяйте различные стили для операций

3. ДЛЯ АНАЛИЗА:
   - Обращайте внимание на критические операции
   - Используйте статистику для оптимизации процессов
   - Анализируйте точки слияния и разветвления

4. ДЛЯ РАБОТЫ С EXCEL:
   - Используйте кнопку "Обновить" если добавили новые листы
   - Программа автоматически запоминает последний выбранный лист
   - Имя выходного файла генерируется на основе имени Excel файла

🎯 КЛЮЧЕВЫЕ ИЗМЕНЕНИЯ ВЕРСИИ 3.0

• УДАЛЕН КОНСОЛЬНЫЙ РЕЖИМ - только графический интерфейс
• АВТОМАТИЧЕСКИЙ ВЫБОР ЛИСТОВ - выпадающий список
• УЛУЧШЕННАЯ ВАЛИДАЦИЯ - проверка обязательных полей
• УПРОЩЕННЫЙ ЗАПУСК - автоматическое открытие GUI
• УДАЛЕН user_input.py - упрощение архитектуры

Обновлено: Версия 3.0 с улучшенным GUI и автоматическим выбором листов