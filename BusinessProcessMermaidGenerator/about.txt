% ГЕНЕРАТОР ДИАГРАММ БИЗНЕС-ПРОЦЕССОВ - ТЕХНИЧЕСКАЯ ДОКУМЕНТАЦИЯ
% Версия 3.1 с поддержкой Causal Loop Diagrams (CLD)
% 
% АРХИТЕКТУРНАЯ СТРУКТУРА СИСТЕМЫ:
% core/ - ЯДРО СИСТЕМЫ
% ├── core_api.py - Фасадный API для координации процессов
% ├── core_engine.py - Бизнес-логика и координация движка
% ├── config_manager.py - Менеджер конфигурации и настроек
% └── models.py - Data classes и доменные модели
%
% data/ - ДАННЫЕ И АНАЛИЗ
% ├── data_loader.py - Загрузка и валидация данных из Excel
% ├── analysis.py - Анализ бизнес-процессов
% └── cld_analyzer.py - Анализатор причинно-следственных связей
%
% exporters/ - СИСТЕМА ЭКСПОРТА
% ├── mermaid_exporter.py - Экспорт в Mermaid (Markdown/HTML)
% ├── html_exporter.py - HTML с Mermaid + панорамирование
% ├── interactive_exporter.py - Интерактивный граф (vis-network)
% ├── cld_mermaid_exporter.py - Causal Loop Diagram в Mermaid
% └── cld_interactive_exporter.py - Интерактивный CLD (vis-network)
%
% ui/ - ПОЛЬЗОВАТЕЛЬСКИЙ ИНТЕРФЕЙС
% ├── main.py - Точка входа (ТОЛЬКО GUI)
% └── gui_interface.py - Графический интерфейс Tkinter
%
% infrastructure/ - ИНФРАСТРУКТУРА
% ├── config.py - Конфигурация и константы
% └── utils.py - Утилиты и вспомогательные функции
%
% КЛЮЧЕВЫЕ АРХИТЕКТУРНЫЕ ПРИНЦИПЫ:
% - Фасадный паттерн: core_api.py скрывает сложность подсистемы
% - Стратегия: различные экспортеры и анализаторы
% - Data Transfer Objects: dataclasses для типобезопасности
% - Принцип единственной ответственности для каждого модуля
%
% ПОТОК ДАННЫХ:
% 1. Загрузка данных: Excel → data_loader → доменные модели Operation
% 2. Анализ: операции → analysis.py → выявление паттернов и статистики
% 3. Экспорт: данные → соответствующий экспортер → файлы диаграмм
%
% ОСНОВНЫЕ КЛАССЫ ДАННЫХ:
% - Operation: бизнес-операция с входами/выходами
% - Choices: настройки генерации из GUI
% - AnalysisData: результаты анализа бизнес-процессов
% - CausalAnalysis: анализ причинно-следственных связей
% - CausalLink: отдельная причинно-следственная связь
%
% ТИПЫ ДИАГРАММ:
% - Бизнес-процессы: поток операций с входами/выходами
% - Causal Loop Diagrams (CLD): причинно-следственные связи
% - Автоматический CLD: строится из бизнес-процессов
% - Ручной CLD: загружается из отдельного листа Excel
%
% ФОРМАТЫ ВЫВОДА:
% - Mermaid Markdown: статические диаграммы в .md
% - HTML Mermaid: интерактивные диаграммы с панорамированием
% - Interactive HTML: полноценные интерактивные графы
% - CLD Mermaid: причинно-следственные диаграммы в Mermaid
% - CLD Interactive: интерактивные CLD графы
%
% АНАЛИТИЧЕСКИЕ ВОЗМОЖНОСТИ:
% - Выявление точек слияния (merge points)
% - Выявление точек разветвления (split points)
% - Супер-критические операции (много входов + многократное использование)
% - Петли обратной связи в CLD
% - Статистика сложности процесса
%
% КЛЮЧЕВЫЕ ФУНКЦИИ ДЛЯ РАЗРАБОТЧИКА:
% - DiagramGenerator.generate_diagram(): главная функция генерации
% - BusinessProcessEngine: координатор всей бизнес-логики
% - load_and_validate_data(): загрузка с валидацией Excel
% - analyse_network(): основной анализ бизнес-процессов
% - analyze_causal_links_from_operations(): построение CLD из БП
% - Экспортеры: возвращают Path к созданным файлам
%
% ОБРАБОТКА ОШИБОК:
% - DataValidationError: ошибки валидации данных
% - CLDValidationError: ошибки валидации CLD данных
% - Единый интерфейс возврата (успех, сообщение, файлы)
% - Логирование на всех этапах
%
% КОНФИГУРАЦИЯ:
% - config.py: константы и стили
% - ConfigManager: сохранение настроек между запусками
% - bp_config.json: файл конфигурации
% - Поддержка разных окружений (разработка/production)
%
% GUI ОСОБЕННОСТИ:
% - Две вкладки: бизнес-процессы и CLD
% - Динамическое обновление интерфейса
% - Автоматическое определение листов Excel
% - Выбор папки для сохранения отчетов
% - Мультивыбор форматов вывода
%
% ТЕХНИЧЕСКИЕ ДЕТАЛИ ЭКСПОРТА:
% - Mermaid: синтаксис диаграмм для Markdown
% - Vis-network: интерактивные графы в HTML
% - HTML2Canvas: экспорт диаграмм в PNG
% - Автоматическое открытие в браузере
% - Горячие клавиши в интерактивных версиях
%
% ВАЛИДАЦИЯ ДАННЫХ:
% - Проверка обязательных колонок в Excel
% - Валидация знаков влияния в CLD (+/-)
% - Обработка пустых значений и дубликатов
% - Нормализация текстовых данных
%
% РАСШИРЕНИЕ СИСТЕМЫ:
% - Добавление нового формата: создать модуль в exporters/
% - Новый анализатор: расширить analysis.py или создать новый
% - Новый источник данных: расширить data_loader.py
% - Все экспортеры возвращают Path и имеют схожий интерфейс
%
% ПРОИЗВОДИТЕЛЬНОСТЬ:
% - Ограничения для больших наборов данных
% - Эффективные алгоритмы поиска петель обратной связи
% - Кэширование промежуточных результатов
% - Оптимизированные структуры данных для графовых операций
%
% ТЕСТИРУЕМОСТЬ:
% - Изолированные модули с четкими интерфейсами
% - Dependency Injection через конструкторы
% - Мокируемые данные для unit-тестов
% - Четкое разделение ответственности
%
% ВЕРСИЯ: 3.1.0 | АРХИТЕКТУРА: Модульная с фасадным паттерном
% ДАТА: 2024 | ЛИЦЕНЗИЯ: MIT