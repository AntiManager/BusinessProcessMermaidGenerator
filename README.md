# Генератор диаграмм бизнес-процессов v3.0

## 📋 О проекте

Профессиональный инструмент для автоматического построения диаграмм бизнес-процессов из данных Excel. Программа анализирует структуру процессов, выявляет критические точки и создает визуализации в различных форматах.

## 🚀 Основные возможности

### Автоматический анализ процессов
- **Точки слияния** - операции с множеством входов
- **Точки разветвления** - операции с множеством выходов  
- **Супер-критические операции** - одновременное слияние и разветвление
- **Внешние входы и конечные выходы** - границы процесса
- **Статистика процесса** - количественные показатели

### Поддерживаемые форматы экспорта
1. **📄 Markdown с Mermaid** - для документации
2. **🌐 HTML с Mermaid** - с панорамированием
3. **🎮 Интерактивный HTML** - динамическая визуализация
4. **🖼️ HTML с SVG** - векторная графика с продвинутой навигацией

## 🏗️ Архитектура проекта

```
business_process_generator/
├── 📁 exporters/ # Модули экспорта
│ ├── mermaid_exporter.py # Экспорт в Mermaid
│ ├── html_exporter.py # HTML с Mermaid + панорамирование
│ ├── interactive_exporter.py # Интерактивный граф (vis-network)
│ └── svg_exporter.py # HTML с SVG (улучшенная навигация)
├── 📄 main.py # Точка входа (только GUI)
├── 📄 gui_interface.py # Графический интерфейс
├── 📄 config_manager.py # Менеджер конфигурации
├── 📄 config.py # Конфигурация и константы
├── 📄 models.py # Data classes и модели
├── 📄 utils.py # Вспомогательные функции
├── 📄 data_loader.py # Загрузка и обработка данных
└── 📄 analysis.py # Анализ бизнес-процессов
```

## 🔧 Требования к данным

### Обязательные колонки в Excel:
- **Операция** - название бизнес-операции
- **Входы** - входные данные/ресурсы (разделитель `;`)
- **Выход** - результаты операции (разделитель `;`)

### Дополнительные колонки:
- **Группа** - категория операции
- **Владелец** - ответственный за операцию
- **Подробное описание операции** - детальное описание

## 🎯 Аналитические возможности

### Критические точки

```python
# Супер-критические операции
if in_cnt >= choices.critical_min_inputs and max_out_cnt >= choices.critical_min_reuse:
    # Обнаружение операций слияния и разветвления
```
## Группировка операций
- По подгруппам (автоматическое определение)

- По владельцам процессов

- По функциональным группам

## Статистика
- Количество операций и групп

- Внешние входы и конечные выходы

- Точки слияния и разветвления

- Супер-критические операции

## 🖥️ Графический интерфейс
### Основные элементы
- Автоматический выбор листов - выпадающий список из Excel

- Настройки визуализации - формат, группировка, детализация

- Пороговые значения - настройка чувствительности анализа

- Предпросмотр возможностей - информация о выбранном формате

### Умные функции
Автоматическое определение листа по умолчанию

Запоминание последних настроек

Валидация входных данных

Информативные сообщения об ошибках

## 📊 Форматы вывода
### 1. Markdown с Mermaid

```mermaid
graph LR
    external_input["Вход"] --> operation["Операция"]
    operation --> final_output["Выход"]
```
**Преимущества:**

- Совместимость с GitHub/GitLab

- Простота редактирования

- Идеально для документации
## 2. HTML с Mermaid
Функциональность:

Интерактивное панорамирование

Масштабирование колесом мыши

Полноэкранный режим

## 3. Интерактивный HTML (vis-network)
Особенности:

Динамическая компоновка узлов

Физическое моделирование связей

Поиск и фильтрация элементов

Детальная информация по узлам

## 4. HTML с SVG (рекомендуемый)
Продвинутая навигация:

```text
┌───────────────────┬────────────────────────────────────────┐
│ Действие          │ Управление                            │
├───────────────────┼────────────────────────────────────────┤
│ Перетаскивание    │ Зажать ЛКМ и двигать мышью           │
│ Масштабирование   │ Колесо мыши вверх/вниз               │
│ Точный зум        │ Ctrl + колесо мыши                   │
│ Сброс вида        │ Кнопка "Сброс" или Ctrl+0            │
│ Вписать в экран   │ Кнопка "Вместить" или Ctrl+1         │
│ Полный экран      │ Кнопка "⛶" или F11                  │
│ Скачать PNG       │ Кнопка "📥 PNG"                      │
└───────────────────┴────────────────────────────────────────┘
```
## 🔍 Алгоритм анализа
1. **Загрузка и валидация данных**

```python
def load_and_validate_data(excel_path, sheet_name, required_columns):
    # Проверка обязательных колонок
    # Обработка множественных входов/выходов
```

2. **Сбор операций**

```python
def collect_operations(df, choices):
    # Объединение данных из нескольких строк
    # Поддержка множественных выходов
    # Формирование текста узлов
```

3. **Анализ сети процессов**

```python
def analyse_network(operations, choices):
    # Определение внешних входов и конечных выходов
    # Анализ точек слияния и разветвления
    # Выявление супер-критических операций
```

4. **Построение диаграммы**
Создание узлов и связей

Применение стилей по типам операций

Группировка при необходимости

Генерация интерактивных элементов

## ⚙️ Конфигурация
**Настройки по умолчанию**

```python
STYLES = {
    "external": "fill:yellow,stroke:#333,stroke-width:2px;",
    "final": "fill:red,stroke:#333,stroke-width:2px,color:white;",
    "merge": "fill:orange,stroke:#333,stroke-width:2px;",
    "split": "fill:purple,stroke:#333,stroke-width:2px,color:white;",
    "critical": "fill:#ff4444,stroke:#000,stroke-width:3px,color:white,stroke-dasharray:5 5;"
}
```

**Параметры анализа**

```python
CRITICAL_MIN_INPUTS = 3    # Минимальное количество входов
CRITICAL_MIN_REUSE = 3     # Минимальное использование выхода
```

## 🎨 Визуализация
**Легенда диаграммы**
🟨 Желтые овалы - внешние входы

🟥 Красные овалы - конечные выходы

🟧 Оранжевые прямоугольники - операции слияния

🟪 Фиолетовые прямоугольники - операции разветвления

🟥 Пульсирующие красные - супер-критические операции

🟦 Синие прямоугольники - стандартные операции

**Группировка**
Визуальное разделение по зонам ответственности

Автоматическое определение подгрупп

Опции отключения группировки

## 🔄 Рабочий процесс
1. **Запуск программы** - автоматическое открытие GUI

2. **Выбор файла Excel** - через диалоговое окно

3. **Автоматическая загрузка листов** - выпадающий список

4. **Настройка параметров:**

- Формат вывода (рекомендуется SVG)

- Группировка операций

- Отображение описания

- Пороги для критических операций

5. **Генерация диаграммы** - автоматическое открытие в браузере

## 💾 Система конфигурации
**Автоматическое сохранение**
- Путь к последнему файлу Excel

- Выбранный лист и настройки

- Предпочтения формата вывода

- Пороговые значения анализа

**Файл конфигурации**

```json
{
  "excel_path": "C:/путь/к/файлу.xlsx",
  "sheet_name": "БП_1",
  "output_format": "html_svg",
  "subgroup_column": "Группа",
  "show_detailed": true,
  "critical_min_inputs": 3,
  "critical_min_reuse": 3,
  "no_grouping": false
}
```

## 🐛 Решение проблем
**Частые вопросы**
Проблема: Не отображаются листы в выпадающем списке
Решение: Нажмите кнопку "Обновить" рядом с выбором листа

Проблема: SVG диаграмма не реагирует на управление
Решение: Убедитесь что JavaScript включен в браузере

Проблема: Ошибка при чтении Excel файла
Решение: Убедитесь что файл не открыт в Excel и имеет правильный формат

## 📈 Преимущества версии 3.0
**Улучшенный пользовательский опыт**
Автоматический выбор листов Excel

Выпадающие списки вместо ручного ввода

Визуальные подсказки и эмодзи

Умное определение значений по умолчанию

**Упрощенная архитектура**
Только графический интерфейс (удален консольный режим)

Удалены избыточные компоненты

Лучшая производительность

**Расширенная функциональность**
Кнопка "Обновить" для перезагрузки листов

Автоматическое именование выходных файлов

Сохранение состояния между сессиями

Адаптация под разные сценарии использования

## 🎯 Рекомендации по использованию
**Для больших диаграмм**
Используйте SVG формат для лучшей производительности

Применяйте группировку для упрощения визуализации

Используйте полноэкранный режим для обзора

**Для презентаций**
Экспортируйте в PNG с нужным масштабом

Используйте подсказки для объяснения узлов

Применяйте различные стили для операций

**Для анализа**
Обращайте внимание на критические операции

Используйте статистику для оптимизации процессов

Анализируйте точки слияния и разветвления

## 🔮 Дальнейшее развитие
**Планируемые улучшения**
Экспорт в дополнительные форматы (PDF, PNG)

Расширенная аналитика процессов

Интеграция с системами BPMN

Поддержка дополнительных источников данных

---

*Обновлено: Версия 3.0 с улучшенным GUI и автоматическим выбором листов*